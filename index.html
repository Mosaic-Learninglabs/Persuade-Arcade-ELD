<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PERSUADE ARCADE - ELD Beginners</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Press Start 2P', cursive;
            background: #001f3f;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #ffd700;
        }

        .game-container {
            width: 95%;
            max-width: 1000px;
            max-height: 90vh;
            background: #003366;
            border: 8px solid #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5), 0 0 50px rgba(255, 215, 0, 0.3);
            overflow-y: auto;
            position: relative;
        }

        .screen {
            display: none;
            padding: 40px;
            text-align: center;
            min-height: 650px;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .screen.active {
            display: flex;
        }

        .game-title {
            font-size: 48px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700;
            margin-bottom: 10px;
            letter-spacing: 3px;
        }

        .subtitle {
            font-size: 16px;
            color: #ffeb3b;
            margin-bottom: 10px;
        }

        .translation {
            font-size: 12px;
            color: #87ceeb;
            font-style: italic;
            margin-bottom: 30px;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            font-size: 14px;
            color: #ffd700;
            display: block;
            margin-bottom: 5px;
        }

        .input-group .label-translation {
            font-size: 10px;
            color: #87ceeb;
            display: block;
            margin-bottom: 8px;
        }

        .input-group input {
            padding: 12px 16px;
            font-size: 14px;
            font-family: 'Press Start 2P', cursive;
            border: 3px solid #ffd700;
            background: #001f3f;
            color: #ffd700;
            width: 250px;
        }

        button {
            padding: 14px 30px;
            font-size: 14px;
            font-family: 'Press Start 2P', cursive;
            background: #ffd700;
            color: #001f3f;
            border: 4px solid #ffd700;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }

        button:hover:not(:disabled) {
            background: #ffeb3b;
            border-color: #ffeb3b;
            transform: scale(1.05);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .score-header {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: #001f3f;
            border: 4px solid #ffd700;
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .player-score {
            padding: 8px 15px;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid #ffd700;
        }

        .player-score.active {
            background: rgba(255, 235, 59, 0.4);
            border-color: #ffeb3b;
            color: #ffeb3b;
        }

        .shuffle-container {
            width: 100%;
            height: 300px;
            background: #001f3f;
            border: 4px solid #ffd700;
            margin: 20px 0;
            position: relative;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 10px;
            padding: 10px;
        }

        .shuffle-emoji {
            font-size: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            user-select: none;
            cursor: default;
            opacity: 0.8;
        }

        .shuffle-emoji.shuffling {
            animation: pulse 0.3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .center-spotlight {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 140px;
            height: 140px;
            border: 4px solid #ffd700;
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), inset 0 0 30px rgba(255, 215, 0, 0.3);
            pointer-events: none;
            z-index: 5;
            animation: spotlight-pulse 1.5s ease-in-out infinite;
        }

        @keyframes spotlight-pulse {
            0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), inset 0 0 30px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.9), inset 0 0 50px rgba(255, 215, 0, 0.5); }
        }

        .shuffle-emoji.in-spotlight {
            z-index: 10;
            opacity: 1;
        }

        .shuffle-emoji.frozen {
            animation: none !important;
        }

        .shuffle-emoji.fading {
            opacity: 0 !important;
            transform: scale(0.5) !important;
            transition: all 0.5s ease;
        }

        .shuffle-emoji.winner {
            animation: winner-grow 1s ease forwards !important;
            z-index: 100;
        }

        @keyframes winner-grow {
            0% { transform: scale(1); }
            50% { transform: scale(2); }
            100% { transform: scale(2.5); }
        }

        .spin-button {
            display: block;
            margin: 0 auto 20px;
            background: #ffd700;
            color: #001f3f;
            border: 4px solid #ffd700;
            font-size: 18px;
            padding: 18px 40px;
        }

        .spin-button:hover:not(:disabled) {
            background: #ffeb3b;
            color: #001f3f;
            transform: scale(1.1);
        }

        .turn-indicator {
            font-size: 14px;
            color: #ffd700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .question-container {
            display: none;
            background: #001f3f;
            border: 4px solid #ffd700;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .question-text {
            font-size: 14px;
            color: #ffd700;
            margin: 10px 0;
            line-height: 1.6;
        }

        .question-translation {
            font-size: 12px;
            color: #87ceeb;
            margin: 10px 0;
            line-height: 1.6;
            font-style: italic;
        }

        .sentence-frames {
            background: #002855;
            border: 2px solid #87ceeb;
            padding: 15px;
            margin: 15px 0;
        }

        .sentence-frames h4 {
            font-size: 12px;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .sentence-frames h4 .spanish {
            color: #87ceeb;
            display: block;
            margin-top: 5px;
        }

        .frame-option {
            font-size: 11px;
            color: #ffeb3b;
            margin: 8px 0;
            line-height: 1.5;
        }

        .frame-spanish {
            font-size: 10px;
            color: #87ceeb;
            margin-left: 10px;
            font-style: italic;
        }

        .vocab-box {
            background: #002855;
            border: 2px solid #ffd700;
            padding: 12px;
            margin: 15px 0;
        }

        .vocab-box h4 {
            font-size: 11px;
            color: #ffd700;
            margin-bottom: 8px;
        }

        .vocab-item {
            font-size: 10px;
            color: #ffeb3b;
            margin: 5px 0;
        }

        .vocab-translation {
            color: #87ceeb;
            margin-left: 8px;
        }

        .timer-bar {
            height: 30px;
            background: #001f3f;
            border: 2px solid #ffd700;
            margin: 15px 0;
            overflow: hidden;
        }

        .timer-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffeb3b);
            transition: width 1s linear;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #001f3f;
            font-weight: bold;
        }

        .timer-fill.warning {
            background: linear-gradient(90deg, #ffa500, #ff8c00);
        }

        .timer-fill.danger {
            background: linear-gradient(90deg, #ff4500, #dc143c);
        }

        .scoring-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .score-button {
            padding: 15px 10px;
            border: 3px solid #ffd700;
            background: #001f3f;
            color: #ffd700;
            font-size: 10px;
            margin: 0;
        }

        .score-button:hover:not(:disabled) {
            background: #ffd700;
            color: #001f3f;
        }

        .score-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .emoji-icon {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .score-spanish {
            font-size: 9px;
            color: #87ceeb;
            margin-top: 3px;
        }

        .final-scores {
            display: flex;
            gap: 30px;
            margin: 30px 0;
            justify-content: center;
        }

        .final-card {
            padding: 20px;
            background: #001f3f;
            border: 4px solid #ffd700;
            min-width: 150px;
        }

        .final-card.winner {
            border-color: #ffeb3b;
            border-width: 6px;
            box-shadow: 0 0 30px #ffeb3b;
        }

        .final-card h3 {
            font-size: 14px;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .final-card.winner h3 {
            color: #ffeb3b;
        }

        .final-card .score {
            font-size: 32px;
            color: #ffd700;
            font-weight: bold;
        }

        .final-card.winner .score {
            color: #ffeb3b;
        }

        .winner-text {
            font-size: 24px;
            color: #ffd700;
            margin: 20px 0;
            font-weight: bold;
        }

        .difficulty-btn {
            transition: all 0.3s ease;
        }

        .difficulty-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .phase-indicator {
            font-size: 16px;
            color: #ffeb3b;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .pause-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 31, 63, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .pause-overlay.active {
            display: flex;
        }

        .pause-menu {
            background: #003366;
            border: 6px solid #ffd700;
            padding: 40px;
            text-align: center;
        }

        .pause-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ffd700;
            color: #001f3f;
            border: 3px solid #ffd700;
            padding: 10px 20px;
            font-size: 12px;
            cursor: pointer;
            z-index: 100;
        }

        .pause-btn:hover {
            background: #ffeb3b;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Intro Screen 1: What This Is -->
        <div class="screen active" id="introScreen1">
            <h1 class="game-title">PERSUADE ARCADE</h1>
            <div style="font-size: 64px; margin: 30px 0;">üéÆ</div>
            <p class="subtitle" style="font-size: 18px; margin: 20px 0;">Practice CONVINCING people in English!</p>
            <p class="translation" style="font-size: 14px;">Practica CONVENCER en ingl√©s!</p>
            <button id="intro1NextBtn" style="margin-top: 50px;">NEXT / SIGUIENTE ‚Üí</button>
        </div>

        <!-- Intro Screen 2: How It Works -->
        <div class="screen" id="introScreen2">
            <h2 class="subtitle" style="font-size: 24px; margin-bottom: 40px;">HOW TO PLAY / C√ìMO JUGAR</h2>
            <div style="text-align: left; max-width: 600px; margin: 0 auto; font-size: 12px; line-height: 2;">
                <div style="margin: 15px 0;">
                    <span style="font-size: 24px;">1Ô∏è‚É£</span> <strong>Get a situation</strong> (You freeze the game)<br>
                    <span style="color: #87ceeb; margin-left: 40px;">Obt√©n una situaci√≥n (Congelas el juego)</span>
                </div>
                <div style="margin: 15px 0;">
                    <span style="font-size: 24px;">2Ô∏è‚É£</span> <strong>Read & prepare</strong> (You get help words)<br>
                    <span style="color: #87ceeb; margin-left: 40px;">Lee y prep√°rate (Recibes palabras de ayuda)</span>
                </div>
                <div style="margin: 15px 0;">
                    <span style="font-size: 24px;">3Ô∏è‚É£</span> <strong>Convince your partner</strong> (Speak for 2 minutes)<br>
                    <span style="color: #87ceeb; margin-left: 40px;">Convence a tu compa√±ero (Habla por 2 minutos)</span>
                </div>
                <div style="margin: 15px 0;">
                    <span style="font-size: 24px;">4Ô∏è‚É£</span> <strong>Your partner scores you</strong><br>
                    <span style="color: #87ceeb; margin-left: 40px;">Tu compa√±ero te califica</span>
                </div>
            </div>
            <button id="intro2NextBtn" style="margin-top: 40px;">GOT IT / ENTENDIDO ‚Üí</button>
        </div>

        <!-- Difficulty Selection Screen -->
        <div class="screen" id="difficultyScreen">
            <h2 class="subtitle" style="font-size: 24px; margin-bottom: 30px;">CHOOSE DIFFICULTY / ELIGE DIFICULTAD</h2>
            <div style="max-width: 500px; margin: 0 auto;">
                <button class="difficulty-btn" data-difficulty="easy" style="margin: 15px 0; width: 100%; padding: 20px; font-size: 12px;">
                    <div style="font-size: 20px; margin-bottom: 8px;">‚≠ê EASY / F√ÅCIL</div>
                    <div style="font-size: 9px; color: #87ceeb;">Familiar situations, simple words<br>Situaciones familiares, palabras simples</div>
                </button>
                <button class="difficulty-btn" data-difficulty="medium" style="margin: 15px 0; width: 100%; padding: 20px; font-size: 12px; border: 4px solid #ffeb3b;">
                    <div style="font-size: 20px; margin-bottom: 8px;">‚≠ê‚≠ê MEDIUM / MEDIO (Recommended)</div>
                    <div style="font-size: 9px; color: #87ceeb;">School & friend topics<br>Temas de escuela y amigos</div>
                </button>
                <button class="difficulty-btn" data-difficulty="hard" style="margin: 15px 0; width: 100%; padding: 20px; font-size: 12px;">
                    <div style="font-size: 20px; margin-bottom: 8px;">‚≠ê‚≠ê‚≠ê HARD / DIF√çCIL</div>
                    <div style="font-size: 9px; color: #87ceeb;">Complex reasoning<br>Razonamiento complejo</div>
                </button>
            </div>
        </div>

        <!-- Welcome Screen (Names) -->
        <div class="screen" id="welcomeScreen">
            <h1 class="game-title">PERSUADE</h1>
            <p class="subtitle">~ SPEAKING GAME ~</p>
            <p class="translation">~ JUEGO DE HABLAR ~</p>

            <div class="input-group">
                <label>PLAYER 1 NAME</label>
                <span class="label-translation">Nombre del Jugador 1</span>
                <input type="text" id="p1Name" placeholder="Enter name" maxlength="15">
            </div>
            <div class="input-group">
                <label>PLAYER 2 NAME</label>
                <span class="label-translation">Nombre del Jugador 2</span>
                <input type="text" id="p2Name" placeholder="Enter name" maxlength="15">
            </div>

            <button id="startBtn" disabled>START / EMPEZAR</button>
        </div>

        <!-- Game Screen -->
        <div class="screen" id="gameScreen">
            <button class="pause-btn" id="pauseBtn">‚è∏ PAUSE</button>

            <div class="score-header">
                <div class="player-score" id="p1Score">P1: 0</div>
                <div class="player-score" id="p2Score">P2: 0</div>
            </div>

            <div class="turn-indicator" id="turnText"></div>
            <div class="phase-indicator" id="phaseText"></div>
            <div class="shuffle-container" id="shuffleContainer">
                <div class="center-spotlight"></div>
            </div>
            <button class="spin-button" id="activateBtn">FREEZE! / ¬°CONGELA!</button>

            <div class="question-container" id="questionDiv">
                <div class="question-text" id="questionText"></div>
                <div class="question-translation" id="questionTranslation"></div>

                <div class="vocab-box">
                    <h4>üí° USEFUL WORDS / PALABRAS √öTILES</h4>
                    <div id="vocabList"></div>
                </div>

                <div class="sentence-frames">
                    <h4>üìù SENTENCE STARTERS <span class="spanish">Frases para Empezar</span></h4>
                    <div id="framesList"></div>
                </div>

                <div class="timer-bar">
                    <div class="timer-fill" id="timerFill">120s</div>
                </div>

                <div style="text-align: center; margin-top: 15px;">
                    <button id="skipReadBtn" style="display: none; background: #87ceeb; border-color: #87ceeb;">
                        READY! SKIP TO PREPARE / ¬°LISTO! SALTAR ‚Üí
                    </button>
                    <button id="skipPrepareBtn" style="display: none; background: #87ceeb; border-color: #87ceeb;">
                        READY TO SPEAK! / ¬°LISTO PARA HABLAR! ‚Üí
                    </button>
                    <button id="doneSpeakingBtn" style="display: none; background: #4CAF50; border-color: #4CAF50; font-size: 16px; padding: 20px 40px;">
                        ‚úì DONE SPEAKING / TERMIN√â DE HABLAR ‚Üí
                    </button>
                </div>

                <div id="scoringSection" style="display: none; background: #002855; border: 3px solid #ffd700; padding: 20px; margin-top: 20px;">
                    <h3 style="font-size: 14px; color: #ffd700; margin-bottom: 20px;">SCORE YOUR PARTNER / CALIFICA A TU COMPA√ëERO</h3>

                    <div style="margin: 15px 0;">
                        <div style="font-size: 11px; color: #ffeb3b; margin-bottom: 8px;">Did they speak clearly? / ¬øHablaron claramente?</div>
                        <div class="rubric-options">
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="clarity" value="0" style="margin-right: 8px;"> Hard to understand / Dif√≠cil de entender (0)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="clarity" value="1" style="margin-right: 8px;"> Mostly clear / Mayormente claro (1)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="clarity" value="2" style="margin-right: 8px;"> Very clear / Muy claro (2)
                            </label>
                        </div>
                    </div>

                    <div style="margin: 15px 0;">
                        <div style="font-size: 11px; color: #ffeb3b; margin-bottom: 8px;">Did they give reasons? / ¬øDieron razones?</div>
                        <div class="rubric-options">
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="reasons" value="0" style="margin-right: 8px;"> No reasons / Sin razones (0)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="reasons" value="1" style="margin-right: 8px;"> One reason / Una raz√≥n (1)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="reasons" value="2" style="margin-right: 8px;"> Two or more / Dos o m√°s (2)
                            </label>
                        </div>
                    </div>

                    <div style="margin: 15px 0;">
                        <div style="font-size: 11px; color: #ffeb3b; margin-bottom: 8px;">Did they use new words? / ¬øUsaron palabras nuevas?</div>
                        <div class="rubric-options">
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="vocabulary" value="0" style="margin-right: 8px;"> No new words / Sin palabras nuevas (0)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="vocabulary" value="1" style="margin-right: 8px;"> 1-2 new words / 1-2 palabras (1)
                            </label>
                            <label style="display: block; margin: 5px 0; font-size: 10px; color: #ffd700;">
                                <input type="radio" name="vocabulary" value="2" style="margin-right: 8px;"> 3+ new words / 3+ palabras (2)
                            </label>
                        </div>
                    </div>

                    <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #ffd700;">
                        <div id="scoreTotal" style="font-size: 16px; color: #ffeb3b; margin-bottom: 15px;">Select all options to see score</div>
                        <button id="submitScoreBtn" style="width: 100%;" disabled>NEXT ROUND / SIGUIENTE ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pause Overlay -->
        <div class="pause-overlay" id="pauseOverlay">
            <div class="pause-menu">
                <h2 style="font-size: 32px; color: #ffd700; margin-bottom: 20px;">‚è∏ PAUSED</h2>
                <p style="font-size: 12px; color: #87ceeb; margin-bottom: 30px;">Game is paused / Juego en pausa</p>
                <button id="resumeBtn" style="margin: 10px;">‚ñ∂ RESUME / CONTINUAR</button>
                <button id="quitBtn" style="margin: 10px; background: #ff4500; border-color: #ff4500;">üè† QUIT / SALIR</button>
            </div>
        </div>

        <!-- End Screen -->
        <div class="screen" id="endScreen">
            <h1 class="game-title">GAME OVER</h1>
            <p class="translation">FIN DEL JUEGO</p>
            <div class="final-scores" id="finalScores"></div>
            <div class="winner-text" id="winnerText"></div>
            <button id="playAgainBtn">PLAY AGAIN / JUGAR DE NUEVO</button>
        </div>
    </div>

    <script>
        const scenarios = [
            {
                id: 1,
                difficulty: 'easy',
                emoji: 'üçï',
                text: 'Your friend has chips but says NO. Convince them to share with you!',
                translation: 'Tu amigo tiene papas pero dice NO. ¬°Conv√©ncelo de compartir contigo!',
                vocab: [
                    'share = compartir',
                    'hungry = tengo hambre',
                    'tomorrow = ma√±ana',
                    'friend = amigo'
                ],
                frames: [
                    'Please! I am very hungry. = ¬°Por favor! Tengo mucha hambre.',
                    'I will share tomorrow. = Compartir√© ma√±ana.',
                    'You are a good friend. = Eres un buen amigo.'
                ]
            },
            {
                id: 2,
                difficulty: 'easy',
                emoji: '‚öΩ',
                text: 'Your friend wants to sit inside. Convince them to play soccer at lunch!',
                translation: 'Tu amigo quiere sentarse adentro. ¬°Conv√©ncelo de jugar f√∫tbol en el almuerzo!',
                vocab: [
                    'play = jugar',
                    'fun = divertido',
                    'need = necesitamos',
                    'team = equipo'
                ],
                frames: [
                    'We need one more player! = ¬°Necesitamos un jugador m√°s!',
                    'It is very fun! = ¬°Es muy divertido!',
                    'You are good at soccer. = Eres bueno en f√∫tbol.'
                ]
            },
            {
                id: 3,
                difficulty: 'medium',
                emoji: '‚úèÔ∏è',
                text: 'Your friend says NO pencils. You have a test! Convince them to help you.',
                translation: 'Tu amigo dice NO l√°pices. ¬°Tienes un examen! Conv√©ncelo de ayudarte.',
                vocab: [
                    'test = examen',
                    'need = necesito',
                    'help = ayudar',
                    'careful = cuidadoso'
                ],
                frames: [
                    'I have a test now! = ¬°Tengo un examen ahora!',
                    'Please help me. = Por favor ay√∫dame.',
                    'I will be very careful. = Tendr√© mucho cuidado.'
                ]
            },
            {
                id: 4,
                difficulty: 'medium',
                emoji: 'üéÆ',
                text: 'The teacher says NO games. You finished all your work early. Convince the teacher!',
                translation: 'El maestro dice NO juegos. Terminaste todo tu trabajo temprano. ¬°Convence al maestro!',
                vocab: [
                    'finished = termin√©',
                    'all = todo',
                    'early = temprano',
                    'quiet = callado'
                ],
                frames: [
                    'I finished all my work. = Termin√© todo mi trabajo.',
                    'I finished early! = ¬°Termin√© temprano!',
                    'I will be very quiet. = Estar√© muy callado.'
                ]
            },
            {
                id: 5,
                difficulty: 'easy',
                emoji: 'ü™ë',
                text: 'Someone took your seat and says NO. Convince them you need this seat!',
                translation: 'Alguien tom√≥ tu asiento y dice NO. ¬°Conv√©ncelo de que necesitas este asiento!',
                vocab: [
                    'seat = asiento',
                    'my = mi/m√≠o',
                    'always = siempre',
                    'see = ver'
                ],
                frames: [
                    'This is my seat. = Este es mi asiento.',
                    'I sit here every day. = Me siento aqu√≠ cada d√≠a.',
                    'I cannot see from there. = No puedo ver desde all√°.'
                ]
            },
            {
                id: 6,
                difficulty: 'medium',
                emoji: 'üë•',
                text: 'The teacher says work alone. Convince the teacher you work better with a partner!',
                translation: 'El maestro dice trabajar solo. ¬°Convence al maestro de que trabajas mejor con un compa√±ero!',
                vocab: [
                    'better = mejor',
                    'together = juntos',
                    'help = ayudar',
                    'learn = aprender'
                ],
                frames: [
                    'We work better together. = Trabajamos mejor juntos.',
                    'We help each other. = Nos ayudamos.',
                    'We learn more this way. = Aprendemos m√°s as√≠.'
                ]
            },
            {
                id: 7,
                difficulty: 'hard',
                emoji: 'üöΩ',
                text: 'The teacher says wait until lunch. You REALLY need to go! Convince the teacher NOW.',
                translation: 'El maestro dice esperar hasta el almuerzo. ¬°REALMENTE necesitas ir! Convence al maestro AHORA.',
                vocab: [
                    'emergency = emergencia',
                    'cannot wait = no puedo esperar',
                    'sick = enfermo',
                    'fast = r√°pido'
                ],
                frames: [
                    'This is an emergency! = ¬°Esto es una emergencia!',
                    'I cannot wait. = No puedo esperar.',
                    'I will be very fast. = Ser√© muy r√°pido.'
                ]
            },
            {
                id: 8,
                difficulty: 'medium',
                emoji: 'üì±',
                text: 'The teacher says NO phone. Your mom is picking you up early! Convince the teacher.',
                translation: 'El maestro dice NO tel√©fono. ¬°Tu mam√° te recoger√° temprano! Convence al maestro.',
                vocab: [
                    'important = importante',
                    'mom = mam√°',
                    'pick up = recoger',
                    'message = mensaje'
                ],
                frames: [
                    'This is very important! = ¬°Esto es muy importante!',
                    'My mom is picking me up. = Mi mam√° me va a recoger.',
                    'I need to send a message. = Necesito mandar un mensaje.'
                ]
            },
            {
                id: 9,
                difficulty: 'medium',
                emoji: 'üéß',
                text: 'The teacher says NO music in class. Convince the teacher music helps you work!',
                translation: 'El maestro dice NO m√∫sica en clase. ¬°Convence al maestro de que la m√∫sica te ayuda a trabajar!',
                vocab: [
                    'focus = concentrar',
                    'better = mejor',
                    'quiet = silenciosa',
                    'noise = ruido'
                ],
                frames: [
                    'Music helps me focus. = La m√∫sica me ayuda a concentrarme.',
                    'I work better with music. = Trabajo mejor con m√∫sica.',
                    'I will use quiet music. = Usar√© m√∫sica silenciosa.'
                ]
            },
            {
                id: 10,
                difficulty: 'medium',
                emoji: 'üèÉ',
                text: 'The teacher wants gym class inside. The weather is perfect! Convince the teacher to go outside.',
                translation: 'El maestro quiere clase de gimnasia adentro. ¬°El clima est√° perfecto! Convence al maestro de ir afuera.',
                vocab: [
                    'weather = clima',
                    'perfect = perfecto',
                    'healthy = saludable',
                    'sun = sol'
                ],
                frames: [
                    'The weather is perfect! = ¬°El clima est√° perfecto!',
                    'We need sun and fresh air. = Necesitamos sol y aire fresco.',
                    'It is more healthy outside. = Es m√°s saludable afuera.'
                ]
            },
            {
                id: 11,
                difficulty: 'easy',
                emoji: 'üçï',
                text: 'Your mom made dinner but you want pizza! Convince your mom to order pizza tonight.',
                translation: '¬°Tu mam√° hizo cena pero t√∫ quieres pizza! Convence a tu mam√° de ordenar pizza esta noche.',
                vocab: [
                    'tired = cansada',
                    'cooked = cocin√≥',
                    'special = especial',
                    'favorite = favorito'
                ],
                frames: [
                    'You are tired. You cooked yesterday. = Est√°s cansada. Cocinaste ayer.',
                    'Today is special! = ¬°Hoy es especial!',
                    'Pizza is my favorite. = Pizza es mi favorito.'
                ]
            },
            {
                id: 12,
                difficulty: 'easy',
                emoji: 'üéÆ',
                text: 'Your friend wants to play a different game. Convince them to play YOUR game!',
                translation: 'Tu amigo quiere jugar un juego diferente. ¬°Conv√©ncelo de jugar TU juego!',
                vocab: [
                    'better = mejor',
                    'try = probar/intentar',
                    'new = nuevo',
                    'cool = genial'
                ],
                frames: [
                    'My game is better! = ¬°Mi juego es mejor!',
                    'Please try it. = Por favor int√©ntalo.',
                    'It is very cool! = ¬°Es muy genial!'
                ]
            },
            {
                id: 13,
                difficulty: 'hard',
                emoji: 'üò¥',
                text: 'Your parent says go to bed. You are not tired! Convince them you can stay up 30 more minutes.',
                translation: 'Tu padre/madre dice ir a dormir. ¬°No est√°s cansado! Conv√©ncelos de que puedes quedarte despierto 30 minutos m√°s.',
                vocab: [
                    'tired = cansado',
                    'homework = tarea',
                    'almost done = casi terminado',
                    'tomorrow = ma√±ana'
                ],
                frames: [
                    'I am not tired! = ¬°No estoy cansado!',
                    'I am almost done with homework. = Casi termino con la tarea.',
                    'Only 30 more minutes! = ¬°Solo 30 minutos m√°s!'
                ]
            },
            {
                id: 14,
                difficulty: 'medium',
                emoji: 'üéÇ',
                text: 'Your friend forgot your birthday! Convince them to celebrate with you this weekend.',
                translation: '¬°Tu amigo olvid√≥ tu cumplea√±os! Conv√©ncelo de celebrar contigo este fin de semana.',
                vocab: [
                    'birthday = cumplea√±os',
                    'forgot = olvid√≥',
                    'celebrate = celebrar',
                    'important = importante'
                ],
                frames: [
                    'You forgot my birthday! = ¬°Olvidaste mi cumplea√±os!',
                    'It is important to me. = Es importante para m√≠.',
                    'Let\'s celebrate this weekend! = ¬°Vamos a celebrar este fin de semana!'
                ]
            },
            {
                id: 15,
                difficulty: 'easy',
                emoji: 'üì∫',
                text: 'Your sibling has the remote. They are watching a baby show! Convince them to change it.',
                translation: 'Tu hermano/hermana tiene el control. ¬°Est√°n viendo un programa para beb√©s! Conv√©ncelos de cambiarlo.',
                vocab: [
                    'change = cambiar',
                    'boring = aburrido',
                    'turn = turno',
                    'baby show = programa para beb√©s'
                ],
                frames: [
                    'This show is for babies! = ¬°Este programa es para beb√©s!',
                    'It is very boring! = ¬°Es muy aburrido!',
                    'It is my turn now. = Es mi turno ahora.'
                ]
            },
            {
                id: 16,
                difficulty: 'hard',
                emoji: 'üèÄ',
                text: 'You are losing in basketball. Your team wants to quit! Convince them to keep playing.',
                translation: 'Est√°n perdiendo en baloncesto. ¬°Tu equipo quiere rendirse! Conv√©ncelos de seguir jugando.',
                vocab: [
                    'quit = rendirse',
                    'win = ganar',
                    'still time = todav√≠a hay tiempo',
                    'try = intentar'
                ],
                frames: [
                    'Don\'t quit! = ¬°No se rindan!',
                    'We can still win! = ¬°Todav√≠a podemos ganar!',
                    'We have time. Let\'s try! = Tenemos tiempo. ¬°Vamos a intentar!'
                ]
            },
            {
                id: 17,
                difficulty: 'medium',
                emoji: 'üçü',
                text: 'Your parent says no fast food. You are SO hungry! Convince them to stop at a restaurant.',
                translation: 'Tu padre/madre dice no comida r√°pida. ¬°Tienes MUCHA hambre! Conv√©ncelos de parar en un restaurante.',
                vocab: [
                    'hungry = hambriento',
                    'starving = muriendo de hambre',
                    'quick = r√°pido',
                    'please = por favor'
                ],
                frames: [
                    'I am starving! = ¬°Me muero de hambre!',
                    'We can be quick! = ¬°Podemos ser r√°pidos!',
                    'Please! Just this time! = ¬°Por favor! ¬°Solo esta vez!'
                ]
            },
            {
                id: 18,
                difficulty: 'hard',
                emoji: 'üêï',
                text: 'Your parent says dogs are too much work. Convince them you can take care of a dog!',
                translation: 'Tu padre/madre dice que los perros son mucho trabajo. ¬°Conv√©ncelos de que puedes cuidar un perro!',
                vocab: [
                    'responsible = responsable',
                    'take care = cuidar',
                    'walk = caminar/pasear',
                    'promise = prometo'
                ],
                frames: [
                    'I am responsible! = ¬°Soy responsable!',
                    'I will walk it every day. = Lo pasear√© cada d√≠a.',
                    'I promise to take care of it! = ¬°Prometo cuidarlo!'
                ]
            },
            {
                id: 19,
                difficulty: 'hard',
                emoji: 'üéí',
                text: 'Group project! Nobody wants to work with the new kid. Convince your group to include them.',
                translation: '¬°Proyecto en grupo! Nadie quiere trabajar con el chico nuevo. Convence a tu grupo de incluirlo.',
                vocab: [
                    'new = nuevo',
                    'nice = amable',
                    'smart = inteligente',
                    'give a chance = dar una oportunidad'
                ],
                frames: [
                    'The new kid is nice! = ¬°El chico nuevo es amable!',
                    'We should give a chance. = Debemos dar una oportunidad.',
                    'Everyone deserves friends. = Todos merecen amigos.'
                ]
            },
            {
                id: 20,
                difficulty: 'medium',
                emoji: 'üí∞',
                text: 'Your friend owes you $5 but says "tomorrow." You need it NOW! Convince them to pay you today.',
                translation: 'Tu amigo te debe $5 pero dice "ma√±ana." ¬°Lo necesitas AHORA! Conv√©ncelo de pagarte hoy.',
                vocab: [
                    'owe = deber',
                    'promise = prometer/promesa',
                    'forgot = olvid√≥',
                    'need = necesitar'
                ],
                frames: [
                    'You promised! = ¬°Prometiste!',
                    'I need it today! = ¬°Lo necesito hoy!',
                    'You always say tomorrow! = ¬°Siempre dices ma√±ana!'
                ]
            },
            {
                id: 21,
                difficulty: 'medium',
                emoji: 'üéß',
                text: 'Your friend took your headphones without asking! Convince them that is not okay.',
                translation: '¬°Tu amigo tom√≥ tus aud√≠fonos sin pedir! Conv√©ncelo de que eso no est√° bien.',
                vocab: [
                    'mine = m√≠o',
                    'ask = preguntar/pedir',
                    'respect = respetar',
                    'permission = permiso'
                ],
                frames: [
                    'Those are mine! = ¬°Esos son m√≠os!',
                    'You need to ask first! = ¬°Necesitas preguntar primero!',
                    'You need to respect my things. = Necesitas respetar mis cosas.'
                ]
            },
            {
                id: 22,
                difficulty: 'easy',
                emoji: 'üè†',
                text: 'Your friend can come over but only for 1 hour. Convince your parent to let them stay longer!',
                translation: 'Tu amigo puede venir pero solo por 1 hora. ¬°Convence a tu padre/madre de dejarlo quedarse m√°s tiempo!',
                vocab: [
                    'longer = m√°s tiempo',
                    'fun = divertido',
                    'rarely = rara vez',
                    'weekend = fin de semana'
                ],
                frames: [
                    'One hour is too short! = ¬°Una hora es muy corta!',
                    'We rarely see each other! = ¬°Rara vez nos vemos!',
                    'It is the weekend! = ¬°Es el fin de semana!'
                ]
            },
            {
                id: 23,
                difficulty: 'medium',
                emoji: 'üé®',
                text: 'Art class! Everyone wants to paint. Convince the class to do a group mural instead!',
                translation: '¬°Clase de arte! Todos quieren pintar. ¬°Convence a la clase de hacer un mural en grupo!',
                vocab: [
                    'together = juntos',
                    'bigger = m√°s grande',
                    'amazing = incre√≠ble',
                    'teamwork = trabajo en equipo'
                ],
                frames: [
                    'A mural is bigger and better! = ¬°Un mural es m√°s grande y mejor!',
                    'We can work together! = ¬°Podemos trabajar juntos!',
                    'It will be amazing! = ¬°Ser√° incre√≠ble!'
                ]
            },
            {
                id: 24,
                difficulty: 'hard',
                emoji: 'üöó',
                text: 'Your parent says walk home. It is raining! Convince them to pick you up from school.',
                translation: 'Tu padre/madre dice caminar a casa. ¬°Est√° lloviendo! Conv√©ncelos de recogerte de la escuela.',
                vocab: [
                    'raining = lloviendo',
                    'wet = mojado',
                    'sick = enfermo',
                    'cold = fr√≠o'
                ],
                frames: [
                    'It is raining! = ¬°Est√° lloviendo!',
                    'I will get very wet and cold! = ¬°Me mojar√© y tendr√© mucho fr√≠o!',
                    'I can get sick! = ¬°Puedo enfermarme!'
                ]
            },
            {
                id: 25,
                difficulty: 'hard',
                emoji: 'üéâ',
                text: 'There is a school dance but your parent says no. Convince them to let you go!',
                translation: 'Hay un baile escolar pero tu padre/madre dice no. ¬°Conv√©ncelos de dejarte ir!',
                vocab: [
                    'dance = baile',
                    'everyone = todos',
                    'safe = seguro',
                    'miss out = perder'
                ],
                frames: [
                    'Everyone is going! = ¬°Todos van!',
                    'It is at school. It is safe! = Es en la escuela. ¬°Es seguro!',
                    'I will miss out! = ¬°Me lo perder√©!'
                ]
            }
        ];

        let game = {
            p1: { name: '', score: 0 },
            p2: { name: '', score: 0 },
            currentPlayer: 1,
            remaining: [...scenarios],
            round: 0,
            timerInt: null,
            shuffleInt: null,
            emojis: [],
            difficulty: 'medium',
            currentPhase: null, // 'read', 'prepare', 'speak'
            isPaused: false
        };

        // Setup
        document.getElementById('intro1NextBtn').addEventListener('click', () => showScreen('introScreen2'));
        document.getElementById('intro2NextBtn').addEventListener('click', () => showScreen('difficultyScreen'));

        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                game.difficulty = btn.dataset.difficulty;
                showScreen('welcomeScreen');
            });
        });

        document.getElementById('p1Name').addEventListener('input', updateStartBtn);
        document.getElementById('p2Name').addEventListener('input', updateStartBtn);
        document.getElementById('startBtn').addEventListener('click', startGame);
        document.getElementById('activateBtn').addEventListener('click', freezeShuffle);
        document.getElementById('playAgainBtn').addEventListener('click', reset);

        document.getElementById('pauseBtn').addEventListener('click', pauseGame);
        document.getElementById('resumeBtn').addEventListener('click', resumeGame);
        document.getElementById('quitBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to quit? / ¬øSeguro que quieres salir?')) {
                reset();
            }
        });

        // Rubric scoring
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', updateScore);
        });

        document.getElementById('submitScoreBtn').addEventListener('click', submitScore);

        // Skip ahead buttons
        document.getElementById('skipReadBtn').addEventListener('click', () => {
            clearInterval(game.timerInt);
            startPreparePhase(game.currentScenario);
        });

        document.getElementById('skipPrepareBtn').addEventListener('click', () => {
            clearInterval(game.timerInt);
            startSpeakPhase(game.currentScenario);
        });

        document.getElementById('doneSpeakingBtn').addEventListener('click', () => {
            clearInterval(game.timerInt);
            showScoring();
        });

        function updateStartBtn() {
            const p1 = document.getElementById('p1Name').value.trim();
            const p2 = document.getElementById('p2Name').value.trim();
            document.getElementById('startBtn').disabled = !(p1 && p2);
        }

        function startGame() {
            game.p1.name = document.getElementById('p1Name').value.trim();
            game.p2.name = document.getElementById('p2Name').value.trim();

            // Filter scenarios by difficulty
            const filteredScenarios = scenarios.filter(s => s.difficulty === game.difficulty);
            game.remaining = [...filteredScenarios].sort(() => Math.random() - 0.5);

            showScreen('gameScreen');
            updateUI();
            startShuffle();
        }

        function startShuffle() {
            const container = document.getElementById('shuffleContainer');
            // Clear any existing emojis
            const emojis = container.querySelectorAll('.shuffle-emoji');
            emojis.forEach(e => e.remove());
            game.emojis = [];

            // Create emoji elements for all remaining scenarios
            game.remaining.forEach(scenario => {
                const el = document.createElement('div');
                el.className = 'shuffle-emoji shuffling';
                el.textContent = scenario.emoji;
                el.dataset.id = scenario.id;
                container.appendChild(el);
                game.emojis.push({element: el, scenario: scenario});
            });

            // Start shuffling positions
            game.shuffleInt = setInterval(() => {
                shufflePositions();
            }, 400);
        }

        function shufflePositions() {
            // Fisher-Yates shuffle of the emoji elements
            const container = document.getElementById('shuffleContainer');
            const elements = [...container.querySelectorAll('.shuffle-emoji')];

            for (let i = elements.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                // Swap positions by swapping in DOM
                if (i !== j) {
                    const temp = elements[i].nextSibling;
                    container.insertBefore(elements[i], elements[j]);
                    container.insertBefore(elements[j], temp);
                }
            }
        }

        function freezeShuffle() {
            document.getElementById('activateBtn').disabled = true;
            clearInterval(game.shuffleInt);

            // Stop animation
            game.emojis.forEach(e => e.element.classList.remove('shuffling'));
            game.emojis.forEach(e => e.element.classList.add('frozen'));

            // Find which emoji is closest to center (in the spotlight)
            const container = document.getElementById('shuffleContainer');
            const containerRect = container.getBoundingClientRect();
            const centerX = containerRect.left + containerRect.width / 2;
            const centerY = containerRect.top + containerRect.height / 2;

            let closest = null;
            let minDist = Infinity;

            game.emojis.forEach(item => {
                const rect = item.element.getBoundingClientRect();
                const emojiCenterX = rect.left + rect.width / 2;
                const emojiCenterY = rect.top + rect.height / 2;
                const dist = Math.sqrt(
                    Math.pow(centerX - emojiCenterX, 2) +
                    Math.pow(centerY - emojiCenterY, 2)
                );
                if (dist < minDist) {
                    minDist = dist;
                    closest = item;
                }
            });

            // Animate selection
            setTimeout(() => {
                game.emojis.forEach(item => {
                    if (item === closest) {
                        item.element.classList.add('winner');
                        item.element.classList.add('in-spotlight');
                    } else {
                        item.element.classList.add('fading');
                    }
                });

                setTimeout(() => {
                    showQuestion(closest.scenario);
                    game.remaining = game.remaining.filter(x => x.id !== closest.scenario.id);
                    container.innerHTML = '<div class="center-spotlight"></div>';
                    game.emojis = [];
                    container.style.display = 'none';
                    document.getElementById('activateBtn').style.display = 'none';
                    startTimer();
                }, 1500);
            }, 500);
        }

        function showQuestion(scenario) {
            game.currentScenario = scenario;

            // Phase 1: READ (30 seconds) - Show scenario only
            game.currentPhase = 'read';
            document.getElementById('phaseText').textContent = 'üìñ READING TIME / TIEMPO DE LECTURA';
            document.getElementById('questionText').textContent = scenario.text;
            document.getElementById('questionTranslation').textContent = scenario.translation;

            // Hide vocab and frames initially
            document.querySelector('.vocab-box').style.display = 'none';
            document.querySelector('.sentence-frames').style.display = 'none';
            document.getElementById('scoringSection').style.display = 'none';

            // Show skip button for read phase
            document.getElementById('skipReadBtn').style.display = 'block';
            document.getElementById('skipPrepareBtn').style.display = 'none';
            document.getElementById('doneSpeakingBtn').style.display = 'none';

            document.getElementById('questionDiv').style.display = 'block';

            // Start Phase 1 timer (30 seconds)
            startPhaseTimer(30, 'read', () => {
                // Phase 2: PREPARE (45 seconds) - Show vocab and frames
                startPreparePhase(scenario);
            });
        }

        function startPreparePhase(scenario) {
            game.currentPhase = 'prepare';
            document.getElementById('phaseText').textContent = 'üí° PREPARATION TIME / TIEMPO DE PREPARACI√ìN';

            // Show vocabulary
            const vocabHtml = scenario.vocab.map(v =>
                `<div class="vocab-item">${v}</div>`
            ).join('');
            document.getElementById('vocabList').innerHTML = vocabHtml;

            // Show sentence frames
            const framesHtml = scenario.frames.map(f =>
                `<div class="frame-option">${f}</div>`
            ).join('');
            document.getElementById('framesList').innerHTML = framesHtml;

            document.querySelector('.vocab-box').style.display = 'block';
            document.querySelector('.sentence-frames').style.display = 'block';

            // Show skip button for prepare phase
            document.getElementById('skipReadBtn').style.display = 'none';
            document.getElementById('skipPrepareBtn').style.display = 'block';
            document.getElementById('doneSpeakingBtn').style.display = 'none';

            // Start Phase 2 timer (45 seconds)
            startPhaseTimer(45, 'prepare', () => {
                // Phase 3: SPEAK (90 seconds)
                startSpeakPhase(scenario);
            });
        }

        function startSpeakPhase(scenario) {
            game.currentPhase = 'speak';
            const speaker = game[`p${game.currentPlayer}`].name.toUpperCase();
            document.getElementById('phaseText').textContent = `üé§ ${speaker} - SPEAK NOW! / ¬°HABLA AHORA!`;

            // Simplify view - keep scenario and key helpers visible
            document.querySelector('.vocab-box').style.opacity = '0.7';
            document.querySelector('.sentence-frames').style.opacity = '0.7';

            // Show "Done Speaking" button - the most important one!
            document.getElementById('skipReadBtn').style.display = 'none';
            document.getElementById('skipPrepareBtn').style.display = 'none';
            document.getElementById('doneSpeakingBtn').style.display = 'block';

            // Start Phase 3 timer (90 seconds)
            startPhaseTimer(90, 'speak', () => {
                // Time's up - show scoring
                showScoring();
            });
        }

        function showScoring() {
            clearInterval(game.timerInt);
            game.currentPhase = 'scoring';
            document.getElementById('phaseText').textContent = 'üìä TIME TO SCORE / HORA DE CALIFICAR';

            // Hide all skip buttons
            document.getElementById('skipReadBtn').style.display = 'none';
            document.getElementById('skipPrepareBtn').style.display = 'none';
            document.getElementById('doneSpeakingBtn').style.display = 'none';

            // Hide question details, show scoring
            document.getElementById('questionDiv').style.display = 'none';
            document.getElementById('scoringSection').style.display = 'block';

            // Reset radio buttons
            document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
            document.getElementById('scoreTotal').textContent = 'Select all options to see score';
            document.getElementById('submitScoreBtn').disabled = true;
        }

        function startPhaseTimer(duration, phase, onComplete) {
            let sec = duration;
            const fill = document.getElementById('timerFill');
            const totalDuration = duration;

            clearInterval(game.timerInt);

            game.timerInt = setInterval(() => {
                if (game.isPaused) return;

                sec--;
                const pct = (sec / totalDuration) * 100;
                fill.style.width = pct + '%';
                fill.textContent = sec + 's';

                fill.className = 'timer-fill';
                if (sec <= Math.floor(totalDuration * 0.33)) fill.classList.add('warning');
                if (sec <= Math.floor(totalDuration * 0.15)) fill.classList.add('danger');

                if (sec <= 0) {
                    clearInterval(game.timerInt);
                    onComplete();
                }
            }, 1000);
        }

        function pauseGame() {
            game.isPaused = true;
            clearInterval(game.shuffleInt);
            document.getElementById('pauseOverlay').classList.add('active');
        }

        function resumeGame() {
            game.isPaused = false;
            document.getElementById('pauseOverlay').classList.remove('active');
            // Restart shuffle if in shuffle phase
            if (game.emojis.length > 0 && game.currentPhase === null) {
                game.shuffleInt = setInterval(() => {
                    shufflePositions();
                }, 400);
            }
        }

        function updateScore() {
            const clarity = document.querySelector('input[name="clarity"]:checked');
            const reasons = document.querySelector('input[name="reasons"]:checked');
            const vocabulary = document.querySelector('input[name="vocabulary"]:checked');

            if (clarity && reasons && vocabulary) {
                const total = parseInt(clarity.value) + parseInt(reasons.value) + parseInt(vocabulary.value);
                let level = 'OK ü§î';
                if (total >= 5) level = 'EXCELLENT üî•';
                else if (total >= 3) level = 'GOOD üëç';

                document.getElementById('scoreTotal').textContent = `TOTAL: ${total} points = ${level}`;
                document.getElementById('submitScoreBtn').disabled = false;
            }
        }

        function submitScore() {
            const clarity = parseInt(document.querySelector('input[name="clarity"]:checked').value);
            const reasons = parseInt(document.querySelector('input[name="reasons"]:checked').value);
            const vocabulary = parseInt(document.querySelector('input[name="vocabulary"]:checked').value);
            const total = clarity + reasons + vocabulary;

            score(total);
        }

        function score(pts) {
            clearInterval(game.timerInt);
            const scorer = game.currentPlayer === 1 ? 2 : 1;
            game[`p${scorer}`].score += pts;
            game.round++;

            if (game.round >= 10) {
                setTimeout(() => endGame(), 1500);
            } else {
                game.currentPlayer = game.currentPlayer === 1 ? 2 : 1;
                game.currentPhase = null;
                setTimeout(() => {
                    document.getElementById('shuffleContainer').style.display = 'grid';
                    document.getElementById('activateBtn').style.display = 'block';
                    document.getElementById('activateBtn').disabled = false;
                    document.getElementById('scoringSection').style.display = 'none';
                    document.getElementById('questionDiv').style.display = 'none';
                    document.querySelector('.vocab-box').style.opacity = '1';
                    document.querySelector('.sentence-frames').style.opacity = '1';
                    updateUI();
                    startShuffle();
                }, 1500);
            }
        }

        function endGame() {
            const p1Wins = game.p1.score > game.p2.score;
            const p2Wins = game.p2.score > game.p1.score;
            const isTie = game.p1.score === game.p2.score;

            let html = '';
            html += `<div class="final-card${p1Wins ? ' winner' : ''}"><h3>${game.p1.name}</h3><div class="score">${game.p1.score}</div></div>`;
            html += `<div class="final-card${p2Wins ? ' winner' : ''}"><h3>${game.p2.name}</h3><div class="score">${game.p2.score}</div></div>`;
            document.getElementById('finalScores').innerHTML = html;

            if (isTie) {
                document.getElementById('winnerText').textContent = 'TIE! / ¬°EMPATE!';
            } else {
                const winner = p1Wins ? game.p1.name : game.p2.name;
                document.getElementById('winnerText').textContent = winner.toUpperCase() + ' WINS! / ¬°GANA!';
            }

            showScreen('endScreen');
        }

        function updateUI() {
            document.getElementById('p1Score').textContent = game.p1.name + ': ' + game.p1.score;
            document.getElementById('p2Score').textContent = game.p2.name + ': ' + game.p2.score;
            document.getElementById('p1Score').classList.toggle('active', game.currentPlayer === 1);
            document.getElementById('p2Score').classList.toggle('active', game.currentPlayer === 2);

            const currentName = game[`p${game.currentPlayer}`].name.toUpperCase();
            document.getElementById('turnText').textContent = '> ' + currentName + ' - YOUR TURN! / ¬°TU TURNO!';
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function reset() {
            clearInterval(game.timerInt);
            clearInterval(game.shuffleInt);
            document.getElementById('shuffleContainer').innerHTML = '<div class="center-spotlight"></div>';
            document.getElementById('pauseOverlay').classList.remove('active');

            game = {
                p1: { name: '', score: 0 },
                p2: { name: '', score: 0 },
                currentPlayer: 1,
                remaining: [...scenarios],
                round: 0,
                timerInt: null,
                shuffleInt: null,
                emojis: [],
                difficulty: 'medium',
                currentPhase: null,
                isPaused: false
            };

            document.getElementById('p1Name').value = '';
            document.getElementById('p2Name').value = '';
            updateStartBtn();
            showScreen('introScreen1');
        }
    </script>
</body>
</html>
